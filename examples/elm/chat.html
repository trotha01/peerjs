<!DOCTYPE HTML>
<html lang="en">
<head>
<title>PeerJS chat demo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">

<link href="fancy.css" rel="stylesheet" type="text/css">

</head>

<body>
<div id="webrtc"></div>

<script type="text/javascript" src="../../dist/peer.js"></script>
<script type='text/javascript' src='helper.js'></script>
<script src="webrtc.js"></script>

<script>
  var app = Elm.Main.fullscreen();

  var myPeer;

  app.ports.createPeer.subscribe(function(id) {
    console.log("> CREATE PEER");
    myPeer = createPeer(id)

    console.log("> WAITING TO OPEN");
    myPeer.on('open', function(id){
      console.log("> PEER OPENED!");
      // console.log("> SEND ID: ", id);
      // app.ports.peerID.send(id);
    });

    mypeer.on('error', function(err) {
      console.log("> ERROR!");
      console.log(err);
  });

  app.ports.connectPeer.subscribe(function(peerId) {
      connectToPeer(mypeer, peerId)
  });

  app.ports.sendData.subscribe(function(word) {
     console.log("> SEND " + word);
     sendMessage(mypeer, word);
  });
});

</script>
</body>
</html>
